# Public Key Cryptography Basics

Discover how **public key ciphers** such as RSA work and explore their use in applications like SSH, digital signatures, and certificates.

---

## Task 1: Introduction

Public key cryptography addresses the challenge of communicating securely and verifying identity over insecure networks.

**Core Concepts**
- **Authentication** – Verifying the identity of the person or system you’re communicating with.  
- **Authenticity** – Ensuring that the data truly comes from the claimed source.  
- **Integrity** – Making sure the data hasn’t been altered during transmission.  
- **Confidentiality** – Restricting access so only authorized parties can read the data.

In the physical world, you rely on seeing and hearing someone to verify these traits.  
In the digital world, **cryptography** provides these assurances.

✅ *Answer:* Let’s begin!

---

## Task 2: Common Use of Asymmetric Encryption

Asymmetric encryption is most often used for **secure key exchange** — agreeing on a shared secret for later use in symmetric encryption.

**Analogy**
- Imagine you ask your friend for a **lock**.  
- You put your secret instructions in a box and lock it using your friend’s lock.  
- Only your friend, who has the **key** to that lock, can open it.

**Mapping the Analogy**
| Analogy Object | Cryptographic System |
|----------------|----------------------|
| Secret Code | Symmetric Cipher and Key |
| Lock | Public Key |
| Lock’s Key | Private Key |

✅ *Answer:* In the analogy, the **lock** represents the **public key**.

---

## Task 3: RSA

**RSA** (Rivest–Shamir–Adleman) is a public-key algorithm used to securely exchange data over insecure networks.

### The Math Behind RSA
RSA relies on the mathematical difficulty of **factoring large prime numbers**.  
It’s easy to multiply two primes together, but very hard to find those primes again from their product.

**Example**
- Prime 1 = 982451653031  
- Prime 2 = 169743212279  
- Product = 166764499494295486767649  

Factoring that product back into its primes is computationally expensive.

**How RSA Works (Simplified)**
1. Choose two primes `p` and `q`.  
2. Compute `n = p × q`.  
3. Compute φ(n) = (p − 1)(q − 1).  
4. Choose `e` such that it is relatively prime to φ(n).  
5. Compute `d` such that `(e × d) mod φ(n) = 1`.  
6. Public key = (e, n) and Private key = (d, n).  
7. Encryption: `ciphertext = plaintext^e mod n`  
   Decryption: `plaintext = ciphertext^d mod n`

**CTF Example Values**
- ✅ `p = 4391`, `q = 6659` → `n = 29293669`  
- ✅ `p = 4391`, `q = 6659` → `φ(n) = 29286280`

---

## Task 4: Diffie–Hellman Key Exchange

**Purpose:** Establishes a shared secret key between two parties over an insecure channel.

### How It Works
1. Agree on a **large prime number** `p` and a **generator** `g`.  
2. Alice picks private key `a`, Bob picks private key `b`.  
3. Alice computes `A = g^a mod p`, Bob computes `B = g^b mod p`.  
4. They exchange `A` and `B` publicly.  
5. Alice computes `key = B^a mod p`; Bob computes `key = A^b mod p`.  
   Both end up with the same shared secret.

**Example**
- `p = 29`, `g = 5`, `a = 13`, `b = 15`  
- Alice: `A = 5^13 mod 29 = 19`  
- Bob: `B = 5^15 mod 29 = 26`  
- Shared key: `key = 10`

✅ *Answers:*  
- `A = 7`  
- `B = 9`  
- Bob’s key = `24`  
- Alice’s key = `24`

---

## Task 5: SSH

**SSH (Secure Shell)** uses asymmetric cryptography for secure remote access.

### Authenticating the Server
When connecting via SSH, your client checks the server’s **public key fingerprint**.  
If the key is unknown, you’re asked to confirm before trusting the connection.

### Authenticating the Client
SSH keys identify you to the server:
- Public key → stored on the server (in `~/.ssh/authorized_keys`)  
- Private key → remains on your local machine  
- Generated using `ssh-keygen` (types: RSA, ECDSA, Ed25519, etc.)

### SSH Private Keys
- Keep them secret; they work like passwords.  
- The private key decrypts data locally; the **passphrase** only protects the key file itself.  
- File permissions should be `600` or stricter.  

✅ *Answer:* The SSH key uses the **RSA** algorithm.

---

## Task 6: Digital Signatures and Certificates

### Digital Signatures
Used to prove **authenticity** and **integrity** of digital messages.  
Created using your **private key** and verified using your **public key**.

**Process**
- Sender encrypts a hash of the message with their private key.  
- Receiver decrypts it with the public key and compares it to a freshly computed hash.  
- If they match, the message is authentic and unmodified.

### Certificates
Used to verify identities online.  
A **Certificate Authority (CA)** digitally signs certificates to prove ownership of a public key.

**Example**
- HTTPS sites like `tryhackme.com` use a certificate chain of trust:
  - Website certificate → Signed by intermediate CA → Signed by trusted Root CA.

✅ *Answer:* A web server proves its identity using a **certificate**.  
✅ *Answer:* Free TLS certificates can be obtained via **Let’s Encrypt**.

---

## Task 7: PGP and GPG

**PGP (Pretty Good Privacy)** and **GPG (GNU Privacy Guard)** are tools for file and email encryption.  
They use **public-key cryptography** to protect data, verify digital signatures, and ensure secure communication.

**Common Use Cases**
- Encrypting emails or files.  
- Signing messages to verify identity.  
- Importing/exporting keys for backup or trust distribution.

**Example Flow**
1. Generate a GPG key pair.  
2. Share your public key with others.  
3. Decrypt messages using your private key.  
4. Protect private keys with strong passphrases.

✅ *Answer:* The decrypted message contained the word **Pineapple**.

---

## Task 8: Conclusion

### Key Terms
- **Cryptography:** Securing communication using codes and ciphers.  
- **Cryptanalysis:** Studying how to break or bypass encryption systems.  
- **Brute-Force Attack:** Trying every possible key or password until success.  
- **Dictionary Attack:** Trying likely words or combinations instead of random keys.

This room focused on **public key cryptography** — asymmetric encryption, RSA, Diffie–Hellman, SSH, digital signatures, certificates, and OpenPGP.

✅ *Answer:* Ensure you’ve noted all techniques and tools from this module.

---

## Key Takeaways

- **Asymmetric Encryption** = uses a public key and private key pair.  
- **RSA** = based on factoring large primes; widely used for encryption and authentication.  
- **Diffie–Hellman** = creates shared keys securely over public channels.  
- **SSH** = authenticates via key pairs; protects server and user identity.  
- **Digital Signatures** = ensure authenticity and integrity of data.  
- **Certificates** = link public keys to verified entities (HTTPS).  
- **PGP/GPG** = encrypt and sign files or emails.  
- **Attacks** = Brute-force and dictionary attacks test encryption strength.
