# ğŸ› ï¸ Offensive Security Tooling â€” Gobuster: The Basics (TryHackMe)

> **Path:** Cyber Security 101 â†’ Offensive Security Tooling  
> **Room:** Gobuster: The Basics  
> **Focus:** Enumeration of web content, subdomains, and virtual hosts using Gobuster

---

## ğŸ”¹ Task 1 â€“ Introduction

### ğŸ“Œ Task Overview (TryHackMe)
This room focuses on the offensive security tool **Gobuster**, often used for reconnaissance. We will explore how this tool can enumerate:
- Web directories and files
- Subdomains
- Virtual hosts (vhosts)

The room follows a **hands-on approach**, allowing us to execute commands and observe real enumeration results.

---

### ğŸ¯ Learning Objectives
- Understand the basics of **enumeration**
- Learn how to use **Gobuster** to enumerate:
  - Web directories and files
  - Subdomains
  - Virtual hosts
- Understand how **wordlists** are used in enumeration

---

### ğŸ§  What â€œEnumerationâ€ Means (Plain English)
Enumeration is the phase where you:
- Ask a system: *â€œWhat exists here?â€*
- Discover **hidden or unlinked resources**
- Build a map of the attack surface

For web servers, this often includes:
- Hidden directories (`/admin`, `/backup`, `/uploads`)
- Files (`.php`, `.txt`, `.bak`)
- Subdomains (`dev.site.com`, `admin.site.com`)
- Virtual hosts hosted on the same IP

Gobuster automates this discovery process by:
1. Taking a **wordlist**
2. Appending each word to a target
3. Observing the serverâ€™s response
4. Reporting what exists

---

### ğŸ§° What Gobuster Is (Conceptually)
**Gobuster** is a **brute-force enumeration tool**, not an exploitation tool.

It does **not**:
- Break into systems
- Exploit vulnerabilities
- Guess passwords

It **does**:
- Discover content the server does not openly advertise
- Reveal misconfigurations
- Identify attack paths for later stages

> ğŸ”‘ Gobuster answers the question:  
> **â€œWhat paths, names, or hosts exist that I canâ€™t see yet?â€**

---

### âœ… Task 1 Completion
The task simply requires acknowledging readiness to learn Gobuster.

âœ”ï¸ No commands required  
âœ”ï¸ No answers required  

---

### ğŸ§ª Hands-On Experimentation (Task 1 Approved)
These steps reinforce foundational understanding before touching real targets.

1. **Check Gobuster availability**
   ```bash
   gobuster --help
````

* Confirms Gobuster is installed
* Displays supported modes (dir, dns, vhost)

2. **Observe Gobusterâ€™s structure**

   * Notice that Gobuster always needs:

     * A **mode** (what youâ€™re enumerating)
     * A **target**
     * A **wordlist**

3. **Mental checklist to remember**

   * Enumeration â‰  exploitation
   * Enumeration feeds later attacks
   * Wordlists are guesses â€” success depends on coverage

---

## ğŸ”¹ Task 2 â€“ Environment and Setup

### ğŸ“Œ Task Overview (TryHackMe)

For this room:

* An **Ubuntu 20.04 VM** acts as the web server
* The server hosts:

  * Multiple **subdomains**
  * Multiple **virtual hosts**
  * Two CMS platforms:

    * WordPress
    * Joomla

Gobuster will be used from the **AttackBox**, where it is already installed.

---

### ğŸ§  Why Environment Setup Matters Here

This lab uses a **local DNS server** on the target machine.

That means:

* Subdomains and vhosts **will not resolve** unless DNS is configured correctly
* Enumeration tools will fail silently or return false negatives if DNS is wrong

ğŸ‘‰ This task ensures **name resolution works before enumeration begins**

---

### ğŸ–¥ï¸ Machines Used

* **Attacker:** TryHackMe AttackBox (Kali-based)
* **Target:** Ubuntu 20.04 Web Server

  * IP Address: `10.67.128.90`

---

### âš™ï¸ DNS Configuration Requirement

The web server also functions as a **DNS server** for the lab environment.

To resolve:

* Subdomains
* Virtual hosts

We must tell our system:

> â€œAsk the target machine for DNS resolution first.â€

---

### ğŸ”§ Command 1: Edit DNS Configuration

```bash
sudo nano /etc/resolv-dnsmasq
```

#### Input Explained (every part)

* `sudo`
  â†’ Runs the command with administrative privileges
  (required to modify system DNS configuration)

* `nano`
  â†’ A terminal-based text editor
  (simple, beginner-friendly editor used frequently in labs)

* `/etc/resolv-dnsmasq`
  â†’ Configuration file used by **dnsmasq**

  * `dnsmasq` is a lightweight DNS forwarder
  * This file defines which DNS servers are queried

---

### âœï¸ Required Change Inside the File

Add the following line **as the first entry**:

```text
nameserver 10.67.128.90
```

#### Why this line matters

* `nameserver` tells the system where to send DNS queries
* `10.67.128.90` is the **target machine**
* By placing it first:

  * DNS queries resolve lab-specific domains correctly
  * Subdomains and vhosts become discoverable

---

### ğŸ’¾ Saving and Exiting Nano

Inside nano:

* `CTRL + O` â†’ Write (save) the file
* `ENTER` â†’ Confirm filename
* `CTRL + X` â†’ Exit nano

---

### ğŸ”„ Command 2: Restart DNS Service

```bash
/etc/init.d/dnsmasq restart
```

#### Input Explained (every part)

* `/etc/init.d/`
  â†’ Directory containing service control scripts

* `dnsmasq`
  â†’ The DNS service responsible for name resolution

* `restart`
  â†’ Stops and restarts the service so changes take effect

âš ï¸ Without restarting the service, the new DNS configuration will **not** be applied.

---

### ğŸ” Verification Step (Optional but Recommended)

```bash
cat /etc/resolv-dnsmasq
```

#### Output Explained

You should see something like:

```text
nameserver 10.67.128.90
nameserver 169.254.169.253
```

* First entry = lab DNS (correct)
* Second entry = fallback DNS

---

### âœ… Task 2 Completion

TryHackMe requires confirmation that:

* `10.67.128.90` was added as the **first nameserver**
* `dnsmasq` was restarted

âœ”ï¸ No answer input required
âœ”ï¸ Correct Answer acknowledged by TryHackMe

---

### ğŸ§ª Hands-On Experimentation (Task 2 Approved)

1. **Understand why this is necessary**

   * Without DNS resolution:

     * `gobuster dns` â†’ fails
     * `gobuster vhost` â†’ fails
   * Enumeration depends on name resolution

2. **Test DNS resolution manually**

   ```bash
   ping some-subdomain.10.67.128.90
   ```

   * Even failed pings can confirm DNS lookup behavior

3. **Real-world takeaway**

   * Always verify:

     * `/etc/resolv.conf`
     * `/etc/resolv-dnsmasq`
     * VPN DNS behavior
   * Enumeration tools depend heavily on DNS correctness

4. **Mental model to retain**

   ```
   Enumeration tool fails?
   â†“
   Check DNS
   â†“
   Check name resolution
   â†“
   Then troubleshoot the tool
   ```

---

Youâ€™re right â€” and thanks for being blunt about it. For **your** notes, â€œthoroughâ€ means:

* capture the **exact THM structure and teaching points**
* keep **all examples** unless theyâ€™re literally redundant
* add the **context glue** (like where it fits in the ethical hacking flow) so future-you instantly understands *why this matters*

Below is a **full replacement Task 3** that fixes both issues:

* âœ… Explicitly ties Gobuster to the ethical hacking workflow (**after recon â†’ into scanning/enumeration**) and explains *why that placement matters*
* âœ… Restores **multiple examples** for Enumeration and Brute Force (not just one)
* âœ… Keeps the `gobuster --help` block from your screenshot
* âœ… Adds â€œwhat each line meansâ€ and *why youâ€™d use it* (your retention style)
* âœ… Includes the THM â€œAnswer the questions belowâ€ with the answers

If this matches your expectations, youâ€™ll say **Task 3 approved** and Iâ€™ll add the Hands-On Experimentation section (per your rules).

---

````markdown
## ğŸ”¹ Task 3 â€“ Gobuster Introduction

### ğŸ“Œ Task Overview (TryHackMe)
Gobuster is an open-source offensive security tool used for **enumeration**. It can be used to discover:
- Web directories and files
- DNS subdomains
- Virtual hosts (vhosts)
- (In some contexts) cloud storage buckets (e.g., S3, GCS)

Gobuster works by **brute forcing names using a wordlist**, then interpreting the targetâ€™s responses to determine what exists.

---

## ğŸ§­ Where Gobuster Fits in Ethical Hacking (Why youâ€™re learning it now)

A common high-level ethical hacking flow looks like this:

1. **Reconnaissance (Recon)**  
   - Gather info with minimal interaction  
   - Example: identifying domains, IP ranges, tech stack, public endpoints

2. **Scanning / Enumeration (Active Discovery)**  
   - Interact with the target to map what exists  
   - Example: open ports, hidden web paths, subdomains, vhosts, services

3. **Vulnerability Discovery / Exploitation**
4. **Post-exploitation / Privilege escalation**
5. **Reporting / Remediation**

âœ… **Gobuster sits right at the transition from Recon into Scanning/Enumeration**  
- Recon tells you *what the target probably is* (web app? domain? IP?)  
- Gobuster helps you **actively discover** things the target doesnâ€™t advertise:
  - hidden directories
  - admin panels
  - dev environments
  - alternate vhosts/subdomains

> ğŸ§  Why this matters:  
> Gobuster often creates the â€œnext step.â€  
> Example: finding `/admin` leads to login testing; finding `dev.example.com` reveals staging apps; finding a vhost reveals an entirely different site.

---

## ğŸ§  Key Concepts: Enumeration vs Brute Force (with multiple examples)

### ğŸ” Enumeration (What exists?)
Enumeration is the process of **listing resources** on a target system â€” whether or not you can access them.

**Examples (web-focused):**
- Finding `/admin` even if it returns `403 Forbidden`
- Discovering `/backup` even if it redirects (`301/302`)
- Identifying `/uploads` or `/api` endpoints that arenâ€™t linked anywhere public

**Examples (DNS / infrastructure-focused):**
- Discovering `dev.example.com`, `staging.example.com`, `admin.example.com`
- Identifying hidden hosts tied to a single IP through vhosts

**Goal:** Build an accurate map of the attack surface.

> Enumeration answers: **â€œWhat exists?â€**  
> Not: â€œCan I access it?â€

---

### ğŸ” Brute Force (Try possibilities until a match is found)
Brute force is the process of **trying many possibilities** until you find a valid hit.

Gobuster brute-forces *names* (not passwords) using a wordlist:
- It guesses directory names (`admin`, `login`, `images`, `backup`)
- It guesses subdomain names (`dev`, `test`, `staging`)
- It guesses vhost names (`admin.site`, `intranet.site`)

**Examples (name brute force):**
- Trying hundreds/thousands of directory names to find a valid endpoint
- Trying common subdomain names to find new entry points
- Trying vhost names to identify alternate sites on the same IP

âœ… Gobuster performs **brute-force enumeration**:
- brute force is the *method* (wordlist guessing)
- enumeration is the *goal* (discovering what exists)

---

## ğŸ§° Gobuster Help Page (Authoritative output from this lab)

### Command Used
```bash
gobuster --help
````

### Input Explained (every part)

* `gobuster`
  â†’ Runs the Gobuster program

* `--help`
  â†’ Prints:

  * Usage format
  * Available commands (modes)
  * Common/global flags

---

### Output Shown (from your screenshot / this room)

```text
Usage:
  gobuster [command]

Available Commands:
  completion  Generate the autocompletion script for the specified shell
  dir         Uses directory/file enumeration mode
  dns         Uses DNS subdomain enumeration mode
  fuzz        Uses fuzzing mode. Replaces the keyword FUZZ in the URL, Headers and the request body
  gcs         Uses gcs bucket enumeration mode
  help        Help about any command
  s3          Uses aws bucket enumeration mode
  tftp        Uses TFTP enumeration mode
  version     shows the current version
  vhost       Uses VHOST enumeration mode (You must probably want to use the IP address as the URL parameter)

Flags:
      --debug               Enable debug output
      --delay duration      Time each thread waits between requests (e.g. 150ms)
  -h, --help                help for gobuster
      --no-color            Disable color output
      --no-error            Don't display errors
      --no-progress         Don't display progress
  -o, --output string       Output file to write results to (defaults to stdout)
  -p, --pattern string      File containing replacement patterns
  -q, --quiet               Don't print the banner and other noise
  -t, --threads int         Number of concurrent threads (default 10)
  -v, --verbose             Verbose output (errors)
  -w, --wordlist string     Path to the wordlist. Set to - to use STDIN.
      --wordlist-offset int Resume from a given position in the wordlist (defaults to 0)

Use "gobuster [command] --help" for more information about a command.
```

---

## ğŸ§  How to Read the Help Output (What each section means)

### 1) Usage

```text
gobuster [command]
```

This means Gobuster is **mode-based**.

* `gobuster` = tool
* `[command]` = the mode (dir/dns/vhost/etc.)

âœ… You normally run it like:

```bash
gobuster dir   ...
gobuster dns   ...
gobuster vhost ...
```

---

### 2) Available Commands (Modes)

These modes tell Gobuster **what kind of â€œname guessingâ€ youâ€™re doing**:

* `dir` â†’ Discover hidden **web paths** (directories/files)
* `dns` â†’ Discover hidden **subdomains**
* `vhost` â†’ Discover hidden **virtual hosts** hosted on the same IP
* `fuzz` â†’ Fuzz requests by replacing `FUZZ` in URL/headers/body
* `s3` / `gcs` â†’ Bucket enumeration (cloud contexts)
* `tftp` â†’ TFTP enumeration
* `version` â†’ Print Gobuster version

> ğŸ§  Quick memory hook
> **dir = paths**, **dns = subdomains**, **vhost = multiple sites on one IP**

---

### 3) Flags (Global options that control behavior)

#### `-u` / `--url`

* Sets the target URL (or base target)
* This is how you tell Gobuster â€œwhat to append words toâ€

#### `-w` / `--wordlist`

* The wordlist is the *dictionary of guesses*
* Each line is tried as a potential directory/subdomain/vhost name

#### `-t` / `--threads` (default 10)

* Controls concurrency (speed)
* Higher = faster, but can increase:

  * timeouts
  * detection
  * instability on weak targets

#### `--delay duration`

* Adds a delay between requests per thread
* Helps reduce noise / evade basic detection

#### `-o` / `--output`

* Saves results to a file (better for reporting and long scans)

#### `-q` / `--quiet`

* Reduces banner/noise output (cleaner result logs)

#### `--debug` and `-v/--verbose`

* Show more details when troubleshooting errors/unexpected behavior

#### `--wordlist-offset`

* Resume a scan from a specific position (handy for interrupted scans)

---

## ğŸ” Example shown in the task (Directory enumeration)

```bash
gobuster dir -u http://example.thm -w /usr/share/wordlists/dirb/small.txt -t 64
```

### Input Explained (every part)

* `gobuster`
  â†’ Run the tool

* `dir`
  â†’ Use **directory/file enumeration mode** (web paths)

* `-u http://example.thm`
  â†’ Target base URL
  Gobuster will append words onto this base.

* `-w /usr/share/wordlists/dirb/small.txt`
  â†’ Wordlist of common directory/file names
  Each line becomes a guess.

* `-t 64`
  â†’ Use 64 threads (more parallel requests = faster scan)

### What Gobuster is doing behind the scenes

If your wordlist includes:

```text
admin
login
images
backup
```

Gobuster will test:

* `http://example.thm/admin`
* `http://example.thm/login`
* `http://example.thm/images`
* `http://example.thm/backup`

Then it reports hits based on HTTP response behavior.

---

## ğŸ§  Why HTTP status codes matter (Gobuster â€œhitsâ€ are not only 200)

A â€œhitâ€ can be:

* `200 OK` â†’ exists and accessible
* `301/302` â†’ exists but redirects
* `403 Forbidden` â†’ exists but access denied (still valuable!)
* `404 Not Found` â†’ likely does not exist

> âœ… **403 is still a win** because it proves the path exists.

---

## ğŸ“ Answer the questions below (TryHackMe)

### Question 1

**What flag do we use to specify the target URL?**

âœ… Answer:

```text
-u
```

### Question 2

**What command do we use for the subdomain enumeration mode?**

âœ… Answer:

```text
dns
```

---

## âš ï¸ Notes / Discrepancies to Remember

* Help output can vary slightly by Gobuster version.
  This block reflects what **this room showed**, which is valid for your long-term â€œlab-traceableâ€ reference notes.
* Mode-specific options exist and should be checked with:

```bash
gobuster dir --help
gobuster dns --help
gobuster vhost --help
```
Perfect ğŸ‘ â€” **Task 3 approved.**

As promised, below is the **Hands-On Experimentation** section for **Task 3**, written to **reinforce decision-making and retention**, not just command memorization.
You can paste this **directly under Task 3** in your existing Markdown.

---

## ğŸ§ª Hands-On Experimentation â€“ Task 3 (Gobuster Introduction)

> This section is intentionally practical. The goal is to ensure future-you remembers **when**, **why**, and **how** to use Gobuster â€” not just the syntax.

---

### ğŸ§  Experiment 1: Choosing the Correct Gobuster Mode (Decision Practice)

Before running Gobuster, ask **one question**:

> â€œWhat am I trying to discover?â€

| Goal | Gobuster Mode | Why |
|----|----|----|
| Find hidden web paths | `dir` | The application may hide admin panels or APIs |
| Find hidden subdomains | `dns` | Different subdomains often host different apps |
| Find multiple sites on one IP | `vhost` | Shared hosting environments |
| Manipulate request locations | `fuzz` | Custom fuzzing beyond simple paths |

ğŸ§© **Mental shortcut to remember**
```

Paths â†’ dir
Names â†’ dns
Sites â†’ vhost

````

---

### ğŸ§ª Experiment 2: Compare Wordlists (Coverage vs Speed)

Run the same enumeration with two different wordlists:

```bash
gobuster dir -u http://example.thm -w /usr/share/wordlists/dirb/common.txt
````

```bash
gobuster dir -u http://example.thm -w /usr/share/wordlists/dirb/big.txt
```

#### Observe:

* Scan duration
* Number of results
* False positives / noise

ğŸ§  **Key takeaway**

* Smaller lists = faster, less noise
* Larger lists = more coverage, more time
* Real engagements often start small â†’ expand later

---

### ğŸ§ª Experiment 3: Understand â€œ403 Forbiddenâ€ as a Win

Run directory enumeration and note any `403` responses.

Ask yourself:

* Why would a directory exist but deny access?
* What might protect it? (auth, IP restrictions, roles)

ğŸ§  **Retention rule**

> `403 â‰  failure`
> `403 = confirmed existence`

This mindset is critical during real pentests and blue-team validation.

---

### ğŸ§ª Experiment 4: Thread Count Impact

Run the same scan with different thread counts:

```bash
gobuster dir -u http://example.thm -w wordlist.txt -t 10
```

```bash
gobuster dir -u http://example.thm -w wordlist.txt -t 50
```

```bash
gobuster dir -u http://example.thm -w wordlist.txt -t 100
```

#### Observe:

* Speed difference
* Errors/timeouts
* Target responsiveness

ğŸ§  **Real-world lesson**

* More threads â‰  always better
* Aggressive threading can:

  * Miss results
  * Trigger defenses
  * Crash weaker services

---

### ğŸ§ª Experiment 5: Mode Awareness Drill (No Execution)

Without running commands, answer these mentally:

1. The site loads fine by IP but shows different content by hostname
   â†’ **Use:** `vhost`

2. You suspect `dev.` or `staging.` versions exist
   â†’ **Use:** `dns`

3. You want to find `/admin`, `/api`, `/uploads`
   â†’ **Use:** `dir`

If you can answer these instantly, the lesson is solidified.

---

### ğŸ§  Big-Picture Retention Summary (Task 3)

* Gobuster is **enumeration**, not exploitation
* It lives **after recon**, **before exploitation**
* It brute-forces **names**, not passwords
* Wordlists define what you *can* discover
* Modes matter more than flags
* Enumeration often creates the **next attack path**

---

### ğŸ“Œ Skill Check (Self-Assessment)

You should now be able to explain, in plain English:

* What Gobuster does
* Why itâ€™s used early in engagements
* Which mode to choose and why
* Why â€œforbiddenâ€ results are valuable

If yes â†’ youâ€™re ready to move on.

---



