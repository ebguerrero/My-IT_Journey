# ğŸ› ï¸ Offensive Security Tooling â€” Gobuster: The Basics (TryHackMe)

> **Path:** Cyber Security 101 â†’ Offensive Security Tooling  
> **Room:** Gobuster: The Basics  
> **Focus:** Enumeration of web content, subdomains, and virtual hosts using Gobuster

---

## ğŸ”¹ Task 1 â€“ Introduction

### ğŸ“Œ Task Overview (TryHackMe)
This room focuses on the offensive security tool **Gobuster**, often used for reconnaissance. We will explore how this tool can enumerate:
- Web directories and files
- Subdomains
- Virtual hosts (vhosts)

The room follows a **hands-on approach**, allowing us to execute commands and observe real enumeration results.

---

### ğŸ¯ Learning Objectives
- Understand the basics of **enumeration**
- Learn how to use **Gobuster** to enumerate:
  - Web directories and files
  - Subdomains
  - Virtual hosts
- Understand how **wordlists** are used in enumeration

---

### ğŸ§  What â€œEnumerationâ€ Means (Plain English)
Enumeration is the phase where you:
- Ask a system: *â€œWhat exists here?â€*
- Discover **hidden or unlinked resources**
- Build a map of the attack surface

For web servers, this often includes:
- Hidden directories (`/admin`, `/backup`, `/uploads`)
- Files (`.php`, `.txt`, `.bak`)
- Subdomains (`dev.site.com`, `admin.site.com`)
- Virtual hosts hosted on the same IP

Gobuster automates this discovery process by:
1. Taking a **wordlist**
2. Appending each word to a target
3. Observing the serverâ€™s response
4. Reporting what exists

---

### ğŸ§° What Gobuster Is (Conceptually)
**Gobuster** is a **brute-force enumeration tool**, not an exploitation tool.

It does **not**:
- Break into systems
- Exploit vulnerabilities
- Guess passwords

It **does**:
- Discover content the server does not openly advertise
- Reveal misconfigurations
- Identify attack paths for later stages

> ğŸ”‘ Gobuster answers the question:  
> **â€œWhat paths, names, or hosts exist that I canâ€™t see yet?â€**

---

### âœ… Task 1 Completion
The task simply requires acknowledging readiness to learn Gobuster.

âœ”ï¸ No commands required  
âœ”ï¸ No answers required  

---

### ğŸ§ª Hands-On Experimentation (Task 1 Approved)
These steps reinforce foundational understanding before touching real targets.

1. **Check Gobuster availability**
   ```bash
   gobuster --help


* Confirms Gobuster is installed
* Displays supported modes (dir, dns, vhost)

2. **Observe Gobusterâ€™s structure**

   * Notice that Gobuster always needs:

     * A **mode** (what youâ€™re enumerating)
     * A **target**
     * A **wordlist**

3. **Mental checklist to remember**

   * Enumeration â‰  exploitation
   * Enumeration feeds later attacks
   * Wordlists are guesses â€” success depends on coverage

---

## ğŸ”¹ Task 2 â€“ Environment and Setup

### ğŸ“Œ Task Overview (TryHackMe)

For this room:

* An **Ubuntu 20.04 VM** acts as the web server
* The server hosts:

  * Multiple **subdomains**
  * Multiple **virtual hosts**
  * Two CMS platforms:

    * WordPress
    * Joomla

Gobuster will be used from the **AttackBox**, where it is already installed.

---

### ğŸ§  Why Environment Setup Matters Here

This lab uses a **local DNS server** on the target machine.

That means:

* Subdomains and vhosts **will not resolve** unless DNS is configured correctly
* Enumeration tools will fail silently or return false negatives if DNS is wrong

ğŸ‘‰ This task ensures **name resolution works before enumeration begins**

---

### ğŸ–¥ï¸ Machines Used

* **Attacker:** TryHackMe AttackBox (Kali-based)
* **Target:** Ubuntu 20.04 Web Server

  * IP Address: `10.67.128.90`

---

### âš™ï¸ DNS Configuration Requirement

The web server also functions as a **DNS server** for the lab environment.

To resolve:

* Subdomains
* Virtual hosts

We must tell our system:

> â€œAsk the target machine for DNS resolution first.â€

---

### ğŸ”§ Command 1: Edit DNS Configuration

```bash
sudo nano /etc/resolv-dnsmasq
```

#### Input Explained (every part)

* `sudo`
  â†’ Runs the command with administrative privileges
  (required to modify system DNS configuration)

* `nano`
  â†’ A terminal-based text editor
  (simple, beginner-friendly editor used frequently in labs)

* `/etc/resolv-dnsmasq`
  â†’ Configuration file used by **dnsmasq**

  * `dnsmasq` is a lightweight DNS forwarder
  * This file defines which DNS servers are queried

---

### âœï¸ Required Change Inside the File

Add the following line **as the first entry**:

```text
nameserver 10.67.128.90
```

#### Why this line matters

* `nameserver` tells the system where to send DNS queries
* `10.67.128.90` is the **target machine**
* By placing it first:

  * DNS queries resolve lab-specific domains correctly
  * Subdomains and vhosts become discoverable

---

### ğŸ’¾ Saving and Exiting Nano

Inside nano:

* `CTRL + O` â†’ Write (save) the file
* `ENTER` â†’ Confirm filename
* `CTRL + X` â†’ Exit nano

---

### ğŸ”„ Command 2: Restart DNS Service

```bash
/etc/init.d/dnsmasq restart
```

#### Input Explained (every part)

* `/etc/init.d/`
  â†’ Directory containing service control scripts

* `dnsmasq`
  â†’ The DNS service responsible for name resolution

* `restart`
  â†’ Stops and restarts the service so changes take effect

âš ï¸ Without restarting the service, the new DNS configuration will **not** be applied.

---

### ğŸ” Verification Step (Optional but Recommended)

```bash
cat /etc/resolv-dnsmasq
```

#### Output Explained

You should see something like:

```text
nameserver 10.67.128.90
nameserver 169.254.169.253
```

* First entry = lab DNS (correct)
* Second entry = fallback DNS

---

### âœ… Task 2 Completion

TryHackMe requires confirmation that:

* `10.67.128.90` was added as the **first nameserver**
* `dnsmasq` was restarted

âœ”ï¸ No answer input required
âœ”ï¸ Correct Answer acknowledged by TryHackMe

---

### ğŸ§ª Hands-On Experimentation 

1. **Understand why this is necessary**

   * Without DNS resolution:

     * `gobuster dns` â†’ fails
     * `gobuster vhost` â†’ fails
   * Enumeration depends on name resolution

2. **Test DNS resolution manually**

   ```bash
   ping some-subdomain.10.67.128.90
   ```

   * Even failed pings can confirm DNS lookup behavior

3. **Real-world takeaway**

   * Always verify:

     * `/etc/resolv.conf`
     * `/etc/resolv-dnsmasq`
     * VPN DNS behavior
   * Enumeration tools depend heavily on DNS correctness

4. **Mental model to retain**

   ```
   Enumeration tool fails?
   â†“
   Check DNS
   â†“
   Check name resolution
   â†“
   Then troubleshoot the tool
   ```

---

## ğŸ”¹ Task 3 â€“ Gobuster Introduction

### ğŸ“Œ Task Overview (TryHackMe)
Gobuster is an open-source offensive security tool used for **enumeration**. It can be used to discover:
- Web directories and files
- DNS subdomains
- Virtual hosts (vhosts)
- (In some contexts) cloud storage buckets (e.g., S3, GCS)

Gobuster works by **brute forcing names using a wordlist**, then interpreting the targetâ€™s responses to determine what exists.

---

## ğŸ§­ Where Gobuster Fits in Ethical Hacking (Why youâ€™re learning it now)

A common high-level ethical hacking flow looks like this:

1. **Reconnaissance (Recon)**  
   - Gather info with minimal interaction  
   - Example: identifying domains, IP ranges, tech stack, public endpoints

2. **Scanning / Enumeration (Active Discovery)**  
   - Interact with the target to map what exists  
   - Example: open ports, hidden web paths, subdomains, vhosts, services

3. **Vulnerability Discovery / Exploitation**
4. **Post-exploitation / Privilege escalation**
5. **Reporting / Remediation**

âœ… **Gobuster sits right at the transition from Recon into Scanning/Enumeration**  
- Recon tells you *what the target probably is* (web app? domain? IP?)  
- Gobuster helps you **actively discover** things the target doesnâ€™t advertise:
  - hidden directories
  - admin panels
  - dev environments
  - alternate vhosts/subdomains

> ğŸ§  Why this matters:  
> Gobuster often creates the â€œnext step.â€  
> Example: finding `/admin` leads to login testing; finding `dev.example.com` reveals staging apps; finding a vhost reveals an entirely different site.

---

## ğŸ§  Key Concepts: Enumeration vs Brute Force (with multiple examples)

### ğŸ” Enumeration (What exists?)
Enumeration is the process of **listing resources** on a target system â€” whether or not you can access them.

**Examples (web-focused):**
- Finding `/admin` even if it returns `403 Forbidden`
- Discovering `/backup` even if it redirects (`301/302`)
- Identifying `/uploads` or `/api` endpoints that arenâ€™t linked anywhere public

**Examples (DNS / infrastructure-focused):**
- Discovering `dev.example.com`, `staging.example.com`, `admin.example.com`
- Identifying hidden hosts tied to a single IP through vhosts

**Goal:** Build an accurate map of the attack surface.

> Enumeration answers: **â€œWhat exists?â€**  
> Not: â€œCan I access it?â€

---

### ğŸ” Brute Force (Try possibilities until a match is found)
Brute force is the process of **trying many possibilities** until you find a valid hit.

Gobuster brute-forces *names* (not passwords) using a wordlist:
- It guesses directory names (`admin`, `login`, `images`, `backup`)
- It guesses subdomain names (`dev`, `test`, `staging`)
- It guesses vhost names (`admin.site`, `intranet.site`)

**Examples (name brute force):**
- Trying hundreds/thousands of directory names to find a valid endpoint
- Trying common subdomain names to find new entry points
- Trying vhost names to identify alternate sites on the same IP

âœ… Gobuster performs **brute-force enumeration**:
- brute force is the *method* (wordlist guessing)
- enumeration is the *goal* (discovering what exists)

---

## ğŸ§° Gobuster Help Page (Authoritative output from this lab)

### Command Used
```bash
gobuster --help
````

### Input Explained (every part)

* `gobuster`
  â†’ Runs the Gobuster program

* `--help`
  â†’ Prints:

  * Usage format
  * Available commands (modes)
  * Common/global flags

---

### Output Shown (from your screenshot / this room)

```text
Usage:
  gobuster [command]

Available Commands:
  completion  Generate the autocompletion script for the specified shell
  dir         Uses directory/file enumeration mode
  dns         Uses DNS subdomain enumeration mode
  fuzz        Uses fuzzing mode. Replaces the keyword FUZZ in the URL, Headers and the request body
  gcs         Uses gcs bucket enumeration mode
  help        Help about any command
  s3          Uses aws bucket enumeration mode
  tftp        Uses TFTP enumeration mode
  version     shows the current version
  vhost       Uses VHOST enumeration mode (You must probably want to use the IP address as the URL parameter)

Flags:
      --debug               Enable debug output
      --delay duration      Time each thread waits between requests (e.g. 150ms)
  -h, --help                help for gobuster
      --no-color            Disable color output
      --no-error            Don't display errors
      --no-progress         Don't display progress
  -o, --output string       Output file to write results to (defaults to stdout)
  -p, --pattern string      File containing replacement patterns
  -q, --quiet               Don't print the banner and other noise
  -t, --threads int         Number of concurrent threads (default 10)
  -v, --verbose             Verbose output (errors)
  -w, --wordlist string     Path to the wordlist. Set to - to use STDIN.
      --wordlist-offset int Resume from a given position in the wordlist (defaults to 0)

Use "gobuster [command] --help" for more information about a command.
```

---

## ğŸ§  How to Read the Help Output (What each section means)

### 1) Usage

```text
gobuster [command]
```

This means Gobuster is **mode-based**.

* `gobuster` = tool
* `[command]` = the mode (dir/dns/vhost/etc.)

âœ… You normally run it like:

```bash
gobuster dir   ...
gobuster dns   ...
gobuster vhost ...
```

---

### 2) Available Commands (Modes)

These modes tell Gobuster **what kind of â€œname guessingâ€ youâ€™re doing**:

* `dir` â†’ Discover hidden **web paths** (directories/files)
* `dns` â†’ Discover hidden **subdomains**
* `vhost` â†’ Discover hidden **virtual hosts** hosted on the same IP
* `fuzz` â†’ Fuzz requests by replacing `FUZZ` in URL/headers/body
* `s3` / `gcs` â†’ Bucket enumeration (cloud contexts)
* `tftp` â†’ TFTP enumeration
* `version` â†’ Print Gobuster version

> ğŸ§  Quick memory hook
> **dir = paths**, **dns = subdomains**, **vhost = multiple sites on one IP**

---

### 3) Flags (Global options that control behavior)

#### `-u` / `--url`

* Sets the target URL (or base target)
* This is how you tell Gobuster â€œwhat to append words toâ€

#### `-w` / `--wordlist`

* The wordlist is the *dictionary of guesses*
* Each line is tried as a potential directory/subdomain/vhost name

#### `-t` / `--threads` (default 10)

* Controls concurrency (speed)
* Higher = faster, but can increase:

  * timeouts
  * detection
  * instability on weak targets

#### `--delay duration`

* Adds a delay between requests per thread
* Helps reduce noise / evade basic detection

#### `-o` / `--output`

* Saves results to a file (better for reporting and long scans)

#### `-q` / `--quiet`

* Reduces banner/noise output (cleaner result logs)

#### `--debug` and `-v/--verbose`

* Show more details when troubleshooting errors/unexpected behavior

#### `--wordlist-offset`

* Resume a scan from a specific position (handy for interrupted scans)

---

## ğŸ” Example shown in the task (Directory enumeration)

```bash
gobuster dir -u http://example.thm -w /usr/share/wordlists/dirb/small.txt -t 64
```

### Input Explained (every part)

* `gobuster`
  â†’ Run the tool

* `dir`
  â†’ Use **directory/file enumeration mode** (web paths)

* `-u http://example.thm`
  â†’ Target base URL
  Gobuster will append words onto this base.

* `-w /usr/share/wordlists/dirb/small.txt`
  â†’ Wordlist of common directory/file names
  Each line becomes a guess.

* `-t 64`
  â†’ Use 64 threads (more parallel requests = faster scan)

### What Gobuster is doing behind the scenes

If your wordlist includes:

```text
admin
login
images
backup
```

Gobuster will test:

* `http://example.thm/admin`
* `http://example.thm/login`
* `http://example.thm/images`
* `http://example.thm/backup`

Then it reports hits based on HTTP response behavior.

---

## ğŸ§  Why HTTP status codes matter (Gobuster â€œhitsâ€ are not only 200)

A â€œhitâ€ can be:

* `200 OK` â†’ exists and accessible
* `301/302` â†’ exists but redirects
* `403 Forbidden` â†’ exists but access denied (still valuable!)
* `404 Not Found` â†’ likely does not exist

> âœ… **403 is still a win** because it proves the path exists.

---

## ğŸ“ Answer the questions below (TryHackMe)

### Question 1

**What flag do we use to specify the target URL?**

âœ… Answer:

```text
-u
```

### Question 2

**What command do we use for the subdomain enumeration mode?**

âœ… Answer:

```text
dns
```

---

## âš ï¸ Notes / Discrepancies to Remember

* Help output can vary slightly by Gobuster version.
  This block reflects what **this room showed**, which is valid for your long-term â€œlab-traceableâ€ reference notes.
* Mode-specific options exist and should be checked with:

```bash
gobuster dir --help
gobuster dns --help
gobuster vhost --help
```
Perfect ğŸ‘ â€” **Task 3 approved.**

As promised, below is the **Hands-On Experimentation** section for **Task 3**, written to **reinforce decision-making and retention**, not just command memorization.
You can paste this **directly under Task 3** in your existing Markdown.

---

## ğŸ§ª Hands-On Experimentation â€“ Task 3 (Gobuster Introduction)

> This section is intentionally practical. The goal is to ensure future-you remembers **when**, **why**, and **how** to use Gobuster â€” not just the syntax.

---

### ğŸ§  Experiment 1: Choosing the Correct Gobuster Mode (Decision Practice)

Before running Gobuster, ask **one question**:

> â€œWhat am I trying to discover?â€

| Goal | Gobuster Mode | Why |
|----|----|----|
| Find hidden web paths | `dir` | The application may hide admin panels or APIs |
| Find hidden subdomains | `dns` | Different subdomains often host different apps |
| Find multiple sites on one IP | `vhost` | Shared hosting environments |
| Manipulate request locations | `fuzz` | Custom fuzzing beyond simple paths |

ğŸ§© **Mental shortcut to remember**
```

Paths â†’ dir
Names â†’ dns
Sites â†’ vhost

````

---

### ğŸ§ª Experiment 2: Compare Wordlists (Coverage vs Speed)

Run the same enumeration with two different wordlists:

```bash
gobuster dir -u http://example.thm -w /usr/share/wordlists/dirb/common.txt
````

```bash
gobuster dir -u http://example.thm -w /usr/share/wordlists/dirb/big.txt
```

#### Observe:

* Scan duration
* Number of results
* False positives / noise

ğŸ§  **Key takeaway**

* Smaller lists = faster, less noise
* Larger lists = more coverage, more time
* Real engagements often start small â†’ expand later

---

### ğŸ§ª Experiment 3: Understand â€œ403 Forbiddenâ€ as a Win

Run directory enumeration and note any `403` responses.

Ask yourself:

* Why would a directory exist but deny access?
* What might protect it? (auth, IP restrictions, roles)

ğŸ§  **Retention rule**

> `403 â‰  failure`
> `403 = confirmed existence`

This mindset is critical during real pentests and blue-team validation.

---

### ğŸ§ª Experiment 4: Thread Count Impact

Run the same scan with different thread counts:

```bash
gobuster dir -u http://example.thm -w wordlist.txt -t 10
```

```bash
gobuster dir -u http://example.thm -w wordlist.txt -t 50
```

```bash
gobuster dir -u http://example.thm -w wordlist.txt -t 100
```

#### Observe:

* Speed difference
* Errors/timeouts
* Target responsiveness

ğŸ§  **Real-world lesson**

* More threads â‰  always better
* Aggressive threading can:

  * Miss results
  * Trigger defenses
  * Crash weaker services

---

### ğŸ§ª Experiment 5: Mode Awareness Drill (No Execution)

Without running commands, answer these mentally:

1. The site loads fine by IP but shows different content by hostname
   â†’ **Use:** `vhost`

2. You suspect `dev.` or `staging.` versions exist
   â†’ **Use:** `dns`

3. You want to find `/admin`, `/api`, `/uploads`
   â†’ **Use:** `dir`

If you can answer these instantly, the lesson is solidified.

---

### ğŸ§  Big-Picture Retention Summary (Task 3)

* Gobuster is **enumeration**, not exploitation
* It lives **after recon**, **before exploitation**
* It brute-forces **names**, not passwords
* Wordlists define what you *can* discover
* Modes matter more than flags
* Enumeration often creates the **next attack path**

---

### ğŸ“Œ Skill Check (Self-Assessment)

You should now be able to explain, in plain English:

* What Gobuster does
* Why itâ€™s used early in engagements
* Which mode to choose and why
* Why â€œforbiddenâ€ results are valuable

If yes â†’ youâ€™re ready to move on.

---

## ğŸ”¹ Task 4 â€“ Use Case: Directory and File Enumeration

### ğŸ“Œ Task Overview (TryHackMe)
Gobuster has a **dir mode**, allowing users to enumerate website directories and their files.  
This mode is useful when performing a penetration test and wanting to understand:
- The directory structure of a website
- How content is organized
- Which directories or files may be hidden but accessible

Websites often follow predictable directory structures, especially when using common CMS platforms (e.g., WordPress). This predictability makes directory enumeration highly effective.

---

## ğŸ§  Why Directory Enumeration Matters

Web applications frequently expose:
- Admin panels
- Backup folders
- API endpoints
- Development artifacts (JavaScript, config files)

Even if links are not visible on the site, directories may still:
- Exist
- Be accessible
- Leak sensitive information

> ğŸ§  **Key idea**  
> Directory enumeration is often the *bridge* between â€œthis is a web appâ€ and â€œthis is how I break in.â€

---

## ğŸŒ³ Example Directory Structure (Conceptual)

TryHackMe provides a simplified example to show how common CMS platforms are laid out:

```text
/html
 â”œâ”€â”€ wordpress
 â”‚   â”œâ”€â”€ wp-admin
 â”‚   â”œâ”€â”€ wp-content
 â”‚   â””â”€â”€ wp-includes
````

### Why this matters

* Attackers can guess these paths without seeing them
* Enumeration tools like Gobuster automate this guessing
* Finding a CMS structure can immediately suggest:

  * Known vulnerabilities
  * Known admin paths
  * Known file locations

---

## ğŸ§° Gobuster dir Mode Help

Gobuster provides built-in help for each mode.
To view help for **directory enumeration mode**:

```bash
gobuster dir --help
```

This displays all flags specific to `dir` mode.

---

## ğŸš© Common dir Mode Flags (From This Task)

Below are the flags highlighted by TryHackMe in this task, with **plain-English explanations**.

---

### `-c` / `--cookies`

Pass cookies along with each request.

**Why this matters:**

* Useful when:

  * A site requires a session cookie
  * You are enumerating after authentication
* Example use case:

  * Enumerating admin-only directories after logging in

---

### `-x` / `--extensions`

Specifies which file extensions to enumerate.

```bash
-x php,js,txt
```

**What this does:**

* Gobuster appends extensions to each word:

  * `admin.php`
  * `admin.js`
  * `admin.txt`

**Why this matters:**

* Many sensitive files are not directories
* JavaScript files often contain:

  * API endpoints
  * Hardcoded secrets
  * Flags (as in this lab)

---

### `-H` / `--headers`

Adds custom HTTP headers to each request.

**Why this matters:**

* Required when:

  * APIs require authorization headers
  * Virtual hosts require a specific `Host:` header

---

### `-k` / `--no-tls-validation`

Skips TLS certificate validation.

**Why this exists:**

* Labs and test servers often use:

  * Self-signed certificates
* Without this flag:

  * Enumeration may fail due to SSL errors

---

###  `-n` / `--no-status`

Hides HTTP status codes in output.

**Use case:**

* Clean output
* But usually **not recommended** during learning

---

###  `-P` / `--password`

Used with `--username` for authenticated requests.

**Why this matters:**

* Allows enumeration **after** credentials are obtained
* Common post-authentication recon step

---

###  `-s` / `--status-codes`

Specifies which HTTP status codes to display.

```bash
--status-codes 200,301,302,403
```

**Why this matters:**

* `403` often indicates:

  * Resource exists
  * Access is restricted
* This is still valuable information

---

###  `-b` / `--status-codes-blacklist`

Specifies which HTTP status codes to hide.

**Example:**

```bash
--status-codes-blacklist 404
```

**Why this matters:**

* Removes noise
* Focuses only on â€œinterestingâ€ responses

---

###  `-U` / `--username`

Used with `--password` for authenticated enumeration.

---

###  `-r` / `--followredirect`

Tells Gobuster to follow HTTP redirects.

**Why this matters:**

* Many sites redirect:

  * `/admin` â†’ `/login`
* Following redirects can reveal hidden flows

---

## ğŸ§ª How to Use dir Mode (Command Format)

### General Syntax

```bash
gobuster dir -u <URL> -w <WORDLIST>
```

---

### Example from the Task (Root Enumeration)

```bash
gobuster dir -u http://www.offensivetools.thm \
-w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt \
-x .js -t 64 -r
```

---

## ğŸ” Line-by-Line Command Breakdown

* `gobuster`
  â†’ Run the Gobuster tool

* `dir`
  â†’ Use **directory and file enumeration mode**

* `-u http://www.offensivetools.thm`
  â†’ Target base URL
  Gobuster will append words to this path

* `-w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt`
  â†’ Medium-sized directory wordlist
  Balances coverage and speed

* `-x .js`
  â†’ Also enumerate JavaScript files
  (critical for this lab)

* `-t 64`
  â†’ Use 64 threads for faster scanning

* `-r`
  â†’ Follow redirects automatically

---

## ğŸ§  Why the `/secret` Directory Stood Out

During enumeration, the directory:

```text
/secret
```

was discovered.

This stood out because:

* It was **not part of a standard CMS path**
* The name implies intentional concealment
* Hidden directories often contain:

  * Developer artifacts
  * Backup files
  * Flags (in lab environments)

âœ… This answered **Question 2** in the task.

---

## ğŸ” Continuing Enumeration Inside `/secret`

Per the task instructions:

> â€œContinue enumerating the directory found in question 2.â€

This means:

* Change the **base URL**
* Re-run Gobuster **inside that directory**

### Command Used

```bash
gobuster dir -u http://www.offensivetools.thm/secret \
-w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt \
-x .js -t 64 -r
```

---

## ğŸ¯ Finding the Target File

Gobuster reported:

```text
/secret/flag.js
```

At this point:

* Enumeration objective is **complete**
* Continuing the scan is unnecessary

> ğŸ§  **Critical skill**
> Enumeration stops once the target artifact is discovered.

---

## ğŸ“¥ Retrieving the File (Enumeration â†’ Inspection)

Gobuster discovers files â€” it does **not** read them.

To inspect the file contents:

```bash
curl http://www.offensivetools.thm/secret/flag.js
```

### Why `curl` works best here

* Sends a direct HTTP request
* Uses the configured DNS correctly
* Avoids browser/VHost quirks
* Prints file contents immediately

The output reveals the **flag**, answering **Question 3**.

---

## ğŸ“ Answer the Questions Below (TryHackMe)

### Question 1

**Which flag do we have to add to our command to skip the TLS verification? Enter the long flag notation.**

âœ… Answer:

```text
--no-tls-validation
```

---

### Question 2

**Enumerate the directories of [www.offensivetools.thm](http://www.offensivetools.thm). Which directory catches your attention?**

âœ… Answer:

```text
secret
```

---

### Question 3

**Continue enumerating the directory found in question 2. You will find an interesting file there with a .js extension. What is the flag found in this file?**

âœ… Answer:

```text
<FLAG FROM flag.js>
```

---

## ğŸ§  Key Takeaways from Task 4

* Gobuster `dir` mode enumerates **both directories and files**
* Extensions (`-x`) dramatically expand discovery
* JavaScript files are **high-value targets**
* Enumeration should stop once the objective is met
* Retrieval is a **separate step** from discovery
* CLI tools (`curl`, `wget`) are often more reliable than browsers in labs

---

## ğŸ§ª Hands-On Experimentation â€“ Task 4 (Directory & File Enumeration)

> This section is designed to harden your intuition around **when to enumerate**, **when to stop**, and **how to pivot from discovery to inspection**.

---

### ğŸ§  Experiment 1: Enumeration Is a Means, Not the Goal

Re-run a directory enumeration, but stop yourself intentionally once you find something interesting.

```bash
gobuster dir -u http://www.offensivetools.thm \
-w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt \
-x .js -t 64 -r
````

#### Practice:

* The moment you see a directory like `/secret`, pause.
* Ask yourself:

  > â€œDoes this discovery create a *new attack surface*?â€

ğŸ§  **Retention rule**

> Enumeration stops when the objective is met â€” not when the wordlist ends.

---

### ğŸ§ª Experiment 2: Directory Pivoting (Recursive Thinking)

Instead of letting Gobuster recurse blindly, **manually pivot**:

```bash
gobuster dir -u http://www.offensivetools.thm/secret \
-w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt \
-x .js -t 64 -r
```

#### Why this matters:

* You are now **scoping enumeration**
* This mirrors real-world methodology:

  * Find interesting path
  * Pivot
  * Enumerate deeper with intent

ğŸ§  **Mental model**

```
Broad scan â†’ narrow focus â†’ deeper scan
```

---

### ğŸ§ª Experiment 3: File Discovery vs File Inspection

Once Gobuster reports:

```text
/secret/flag.js
```

Do **not** continue enumerating.

Instead, retrieve it:

```bash
curl http://www.offensivetools.thm/secret/flag.js
```

or:

```bash
wget http://www.offensivetools.thm/secret/flag.js
cat flag.js
```

#### Ask yourself:

* Why is `curl` more reliable than a browser here?
* What does this tell you about:

  * DNS resolution
  * Virtual hosts
  * Lab environments vs real environments

ğŸ§  **Retention rule**

> Gobuster discovers.
> `curl` / `wget` inspect.

---

### ğŸ§ª Experiment 4: Extension Awareness Drill

Run the same scan **with and without** extensions:

```bash
gobuster dir -u http://www.offensivetools.thm \
-w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
```

```bash
gobuster dir -u http://www.offensivetools.thm \
-w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt \
-x js
```

#### Observe:

* What appears only when extensions are added
* How many important artifacts are **files**, not directories

ğŸ§  **Key takeaway**

> Files are often more dangerous than directories
> (especially `.js`, `.json`, `.bak`, `.env`)

---

### ğŸ§ª Experiment 5: When to Stop a Scan (Professional Judgment)

Practice stopping Gobuster intentionally:

* Let it run for a few minutes
* Once you identify:

  * A sensitive directory
  * A config file
  * A script file
* Stop the scan manually (`CTRL + C`)

Ask:

* â€œWhatâ€™s my next *logical* step?â€
* â€œAm I still discovering new surface, or just burning time?â€

ğŸ§  **This judgment is what separates junior from intermediate testers.**

---

### ğŸ§  Big-Picture Retention Summary (Task 4)

* Directory enumeration reveals **structure**
* File enumeration reveals **logic and secrets**
* JavaScript files are high-value targets
* Enumeration should be **purpose-driven**
* Stop scanning when the next action becomes inspection or exploitation
* CLI tools often outperform browsers in lab and vhost-heavy environments

---

### ğŸ“Œ Self-Check (If you can answer these, youâ€™ve got it)

* Why did `/secret` matter?
* Why was `.js` enumeration necessary?
* Why was `curl` the correct next tool?
* When should enumeration stop?

If you can answer these without looking â€” Task 4 is locked in.

---




